<?php 

if($threadlist) { 
        $forum_allow_read = array();
        foreach($threadlist as $k=>$_thread) {
                // 判断查看权限
                if(!isset($forum_allow_read[$_thread['fid']])) $forum_allow_read[$_thread['fid']] = forum_access_user($_thread['fid'], $gid, 'allowread');
                // !$forum_allow_read[$_thread['fid']] && 
                // 判断管理权限
                if($_thread['deleted'] > 0) {
                        $threadlist[$k]['top_class'] .= ' deleted';
                        if(!$group['allowharddelete']) {
                                unset($threadlist[$k]);
                        }
		}
        }
}
?>


